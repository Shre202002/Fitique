// Your core authentication logic.
// Handles Google login, email/password, and populates JWT + session with role, name, etc.